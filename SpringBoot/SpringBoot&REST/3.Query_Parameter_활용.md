## Spring Boot & REST 
### Query Parameter í™œìš©
### Query Component
> http:// wxample.com/path?query=keyword&limit=2-
- URL êµ¬ì¡°ì—ì„œ `?` ë’¤ëŠ” Query Componentë¥¼ ì˜ë¯¸
- ìš”êµ¬í•˜ëŠ” ìì›ì— ëŒ€í•œ ë™ì ì¸ ì¡°ê±´ì„ ì „ë‹¬í•˜ëŠ” ìš©ë„
- í˜ì´ì§€, ê²€ìƒ‰ ë“±ì— í™œìš©
- `?` ë’¤ì— `key(ì¸ì ì´ë¦„) = value(ê°’)` í˜•ì‹ìœ¼ë¡œ í™œìš©, ê° ì¸ìëŠ” `&`ë¡œ êµ¬ë¶„
  - query: keyword
  - limit: 20

---
### `@RequestParam`
- Springì˜ `RequestMappling` ë©”ì„œë“œì—ëŠ” `@RequestParam`ì„ ì´ìš©í•´ Queryì˜ ì¸ì ë°›ê¸° ê°€ëŠ¥
```java
@RequestParam(value = "query", defaultValue = "hello") String queryParam,
@RequestParam(value = "limit", required = false) Integer limit
```
- `defalutValue` : ê¸°ë³¸ê°’ ì„¤ì •
- `required` : í•„ìˆ˜ í¬í•¨ ì—¬ë¶€

---
### Pagination
- ì¡°íšŒí•  ë°ì´í„°ì˜ ê°¯ìˆ˜ê°€ ë§ì„ ë–„, ì¡°íšŒë˜ëŠ” ë°ì´í„°ì˜ ê°¯ìˆ˜ë¥¼ í•œì •ì‹œì¼œ í˜ì´ì§€ ë‹¨ìœ„ë¡œ ë‚˜ëˆ„ëŠ” ê¸°ë²•
1. ì¡°íšŒí•  ë°ì´í„°ì˜ ê°¯ìˆ˜ê°€ ì¤„ì–´ë“¤ê¸° ë•Œë¬¸ì— ì„±ëŠ¥ í–¥ìƒì„ ê¾€í•  ìˆ˜ ìˆìŒ
2. ì‚¬ìš©ìê°€ ë°ì´í„°ë¥¼ í™•ì¸í•˜ëŠ” ê³¼ì •ì—ì„œ í™•ì¸í•´ì•¼ í•˜ëŠ” ë°ì´í„°ë¥¼ ì¤„ì—¬ UXê°€ í–¥ìƒë¨


- Query Methodë¥¼ í™œìš©í•´ì„œ ê°€ì ¸ì˜¬ ë°ì´í„°ì˜ ê°¯ìˆ˜ë¥¼ í•œì •ì‹œì¼œ ì¡°íšŒ
```java
// IDê°€ í° ìˆœì„œëŒ€ë¡œ ìµœìƒìœ„ 20ê°œ
List<Article> findTop20ByOrderByIdDesc();

// IDê°€ íŠ¹ì • ê°’ë³´ë‹¤ ì‘ì€ ë°ì´í„° ì¤‘ í° ìˆœì„œëŒ€ë¡œ ìµœìƒìœ„ 20ê°œ
List<Article> findTop20ByIdLessThanOrderByIdDesc(Long id);
```
- `findTop20ByOrderByIdDesc()` : IDë¥¼ ì—­ìˆœìœ¼ë¡œ ìƒìœ„ 20ê°œ ì¡°íšŒ
- `findTop20ByIdLessThanOrderByIdDesc(Long id)` : ì£¼ì–´ì§„ idë³´ë‹¤ IDê°€ ì‘ì€ ë°ì´í„°ë¥¼ IDì—­ìˆœìœ¼ë¡œ ìƒìœ„ 20ê°œ ì¡°íšŒ
- ë‹¤ìŒ í˜ì´ì§€ë¥¼ ìš”ì²­í•  ë•Œ ë§ˆì§€ë§‰ìœ¼ë¡œ í™•ì¸ëœ ID ë‹¤ìŒì˜ ë°ì´í„°ë¶€í„° ë‹¤ìŒ í˜ì´ì§€ë¡œ ë°˜í™˜í•˜ëŠ” ë°©ì‹
  - => í´ë¼ì´ì–¸íŠ¸ê°€ ë§ˆì§€ë§‰ìœ¼ë¡œ í™•ì¸í•œ ë°ì´í„°ì˜ IDë¥¼ ê°™ì´ ë³´ë‚´ê±°ë‚˜
  - ë³´ê³ ì‹¶ì€ í˜ì´ì§€ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì„œë²„ì—ì„œ ê³„ì‚°í•´ì•¼ í•¨
  - `JpaRepository`ê°€ ìƒì†ë°›ê³  ìˆëŠ” `PagingAndSortingRepository`ì˜ ê¸°ëŠ¥ í™œìš©í•˜ë©´ ì‰½ê²Œ êµ¬í˜„ ê°€ëŠ¥

---
### JPAì™€ Pagination
- `Pageable`
  - `PagingAndSortingRepository`ì˜ ë©”ì„œë“œì— ì „ë‹¬í•  ìˆ˜ ìˆëŠ” í˜ì´ì§€ êµ¬ë¶„ ìš©ë„
  - `PageRequest.of()` : í•œ í˜ì´ì§€ì—ì„œ í™•ì¸í•  ë°ì´í„°ì˜ ê°¯ìˆ˜ ì„¤ì •
```java
// 20ê°œ ë‹¨ìœ„ë¡œ ë‚˜ëˆ„ì—ˆì„ë•Œ, 0ë²ˆì§¸ í˜ì´ì§€
Pageable pageable = PageRequest.of(0, 20);
```
- ë°ì´í„°ë¥¼ ì¡°íšŒí•  ë•Œ, 20ê°œì”© ë‚˜ëˆ„ì–´ì„œ í˜ì´ì§€ë¥¼ êµ¬ë¶„í•˜ê³ , 0ë²ˆì§¸ í˜ì´ì§€ì˜ ë°ì´í„°ë¥¼ ì „ë‹¬ë°›ê³  ì‹¶ë‹¤ëŠ” ì¡°ê±´ì„ ë‚˜íƒ€ë‚¸ ê²ƒ
- `Pageable`ì€ ì¸ë±ìŠ¤ê°€ 0ë¶€í„° ì‹œì‘
- ì´ ê°ì²´ë¥¼ `findAll()` ë©”ì„œë“œì— ì¸ìë¡œ ì „ë‹¬í•˜ë©´ `Page<Article>` ê°ì²´ë¥¼ ë°˜í™˜
```java
Page<Article> articleEntityPage = repository.findAll(pageable);
```
- `Page` : í˜ì´ì§€ì— ëŒ€í•œ ì •ë³´ë¥¼ í¬í•¨í•œ ê°ì²´

- `Page<Entity>` ìˆœíšŒ
```java
Page<Article> articleEntityPage = repository.findAll(pageable);
List<ArticleDto> articleDtoList = new ArrayList<>();
for (Article entity : articleEntityPage) {
    articleDtoList.add(ArticleDto.fromEntity(entity));
        }
```
- `Page<Entity>`ë¥¼ `Page<Dto>`ë¡œ
```java
return articleEntityPage.map(ArticleDto::fromEntity);
```
---
### URL
- ê¸°ë³¸ì ìœ¼ë¡œ Paginationì€ ìš”êµ¬í•  ìƒˆë¡œìš´ ìì›ì´ ìƒê¸°ëŠ” ê²ƒì´ ì•„ë‹Œ, íŠ¹ì • ìì›ì˜ ë°ì´í„° ì¤‘ ì¼ë¶€ë§Œ ìš”êµ¬í•˜ëŠ” í–‰ìœ„    
- URLì€ `GET /articles`ë“± ë³¸ë˜ì˜ ì „ì²´ ì¡°íšŒ URLì— Query Parameterë¥¼ ì¶”ê°€í•œ í˜•íƒœë¡œ í™œìš©   
- í•„ìš”í•œ ì •ë³´
- 1. í˜„ì¬ ì¡°íšŒí•˜ê³  ì‹¶ì€ í˜ì´ì§€
- 2. í•œ í˜ì´ì§€ì—ì„œ í™•ì¸í•  ë°ì´í„°ì˜ ê°¯ìˆ˜
> ğŸ’¡ GET /articles?page=1&limit=20

- `Controller`
```java
@GetMapping
public Page<ArticleDto> readAll(
    @RequestParam(value = "page", defaultValue = "1") 
    Integer pageNumber,
    @RequestParam(value = "limit", defaultValue = "20") 
    Integer pageSize
)
```
- ìƒí™©ì— ë”°ë¼ ê°’ì„ ë„£ì–´ì£¼ì§€ ì•ŠëŠ” ê²½ìš°ë¥¼ ê³ ë ¤í•˜ì—¬ `defaultValue` ë¥¼ ì´ìš©í•´ ì²« í˜ì´ì§€ë¥¼ ê¸°ë³¸ê°’ìœ¼ë¡œ ì„¤ì •

---
### Search
- ê°„ë‹¨í•œ ê²€ìƒ‰ ê¸°ëŠ¥ => `WHERE` ì ˆ í™œìš©í•´ì„œ êµ¬í˜„ ê°€ëŠ¥
- ì œëª©ì´ë¼ëŠ” í•­ëª©ì— ëŒ€í•´ì„œë§Œ ìƒê°í•˜ë©´ `JpaRepository`ì— Query Method ì¶”ê°€ë¡œ êµ¬í˜„ ê°€ëŠ¥
```java
List<Article> findAllByTitleContains(String title);
```
- `JpaRepository(PagingAndSortingRepository)` ì‚¬ìš©ì¤‘ ì´ë¼ë©´, Query Methodì— `Pageable` ì¶”ê°€ ê°€ëŠ¥
- ê²€ìƒ‰ ê²°ê³¼ë¥¼ í˜ì´ì§€ ë‹¨ìœ„ë¡œ ë‚˜ëˆ ì„œ í™•ì¸í•  ìˆ˜ ìˆìŒ
```java
Page<Article> findAllByTitleContains(String title, Pageable pageable);
```
- ë°˜í™˜ ê°’ì€ `Page`ì™€ `List` ë‘˜ ë‹¤ ê°€ëŠ¥
---
### Query By Example
-  `Example`ì´ë¼ëŠ” ê°ì²´ë¥¼ í™œìš©í•´, `Example`ì„ ê¸°ì¤€ìœ¼ë¡œ ìœ ì‚¬í•œ `Entity`ë¥¼ ê²€ìƒ‰í•˜ëŠ” ê¸°ëŠ¥
- `ExampleMatcher` : ë¹„êµ ê¸°ì¤€ì„ ì •ì˜í•˜ëŠ” ìš©ë„ì˜ ê°ì²´(ê²€ìƒ‰ ê¸°ì¤€)
```java
ExampleMatcher matcher = ExampleMatcher.matchingAny()
        .withIgnoreCase()
        .withStringMatcher(ExampleMatcher.StringMatcher.CONTAINING);
```
- `matchingAny()` : ì£¼ì–´ì§€ëŠ” ê²€ìƒ‰ ê¸°ì¤€ì˜ ê° í•„ë“œ ì¤‘ í•˜ë‚˜ë¼ë„ ì¼ì¹˜í•˜ë©´ ì¡°íšŒ
- `withIgnoreCase()` : ëŒ€ì†Œë¬¸ìë¥¼ êµ¬ë¶„í•˜ì§€ ì•ŠëŠ” ì˜µì…˜
- `withStringMatcher(ExampleMatcher.StringMatcher.CONTAINING)` : ê²€ìƒ‰ ë¬¸ìì—´ì´ ë°ì´í„°ì— í¬í•¨ë˜ì–´ ìˆìœ¼ë©´ ì¡°íšŒ

- `Entity`ì˜ í˜•ì‹ìœ¼ë¡œ ë¹„êµ ê¸°ì¤€ì„ ì •ì˜
```java
Article probe = new Article();
        probe.setTitle(query);
        probe.setContent(query);
```
- `probe`ê°€ ê°€ì§„ í•„ë“œ ì¤‘ null ì´ ì•„ë‹Œ í•„ë“œë¥¼ `matcher`ì— ì •ì˜í•œ ê¸°ì¤€ìœ¼ë¡œ `Example` ê°ì²´ ìƒì„±
```java
Example<Article> example = Example.of(probe, matcher);
```
- `repository.findAll()` ì„ í™œìš©í•´ `example`ì„ ì¸ìë¡œ ì „ë‹¬
```java
Pageable pageable = PageRequest.of(0, 20);
repository.findAll(example, pageable);
```
- `Article` ì¤‘ `probe`ì˜ `null`ì´ ì•„ë‹Œ í•„ë“œë¥¼ í¬í•¨í•œ `Article`ì˜ ëª©ë¡ì„ ì¡°íšŒ
- ë¬¸ìì—´ì„ ì œì™¸í•œ ì¡°ê±´ì— ëŒ€í•´ì„œ ì •ì˜í•˜ê¸° ê¹Œë‹¤ë¡­ë‹¤ëŠ” ë‹¨ì  ë•Œë¬¸ì— ë§ì´ í™œìš©ë˜ì§€ ì•ŠìŒ
---
### URL
- ê²€ìƒ‰ ê¸°ëŠ¥ì€ êµ¬í˜„í•˜ê³ ì í•˜ëŠ” ì„œë¹„ìŠ¤ì— ë”°ë¼ URLì„ ë‹¤ì–‘í•˜ê²Œ êµ¬ì„±
> ğŸ’¡ github.com/search?q=asdf&type=repositories&p=2
- githubì˜ ì˜ˆì‹œ
- `/search` ê²½ë¡œë¥¼ ê¸°ë°˜
- `q` : ê²€ìƒ‰ì–´
- `type` : ê²€ìƒ‰ ê²°ê³¼ ë¶„ë¥˜
- `p` : ê²°ê³¼ í˜ì´ì§€
---
- ê°„ë‹¨í•˜ê²Œ `/search` ë’¤ìª½ì˜ `query` íŒŒë¼ë¯¸í„°ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì œëª©, ë‚´ìš©ì„ ê¸°ì¤€ìœ¼ë¡œ ê²€ìƒ‰í•˜ê³  
- `page` íŒŒë¼ë¯¸í„°ë¥¼ ê¸°ì¤€ìœ¼ë¡œ í˜ì´ì§€ë¥¼ ë‚˜ëˆˆë‹¤ë©´ ì•„ë˜ì²˜ëŸ¼ êµ¬ì„±í•  ìˆ˜ ìˆìŒ
```text
GET /search?query=title&page=1
```
```java
@GetMapping("/search")
public Page<ArticleDto> search(
        @RequestParam("query") String query,
        @RequestParam(value = "page", defaultValue = "0") 
        Integer pageNumber
) {
    return this.service.searchArticles(query, pageNumber);
}
```